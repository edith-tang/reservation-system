@model ReservationSystem.Models.Reservation.CreateReservation

@{
    ViewData["Title"] = "Create Reservation";

    var firstDay = new DateTime(DateTime.Today.Year, DateTime.Today.Month, 1).ToShortDateString();
    var lastDay = new DateTime(Model.MaxDate.Year, Model.MaxDate.Month, DateTime.DaysInMonth(Model.MaxDate.Year,
                                                        Model.MaxDate.Month)).ToShortDateString();
    var minDay = DateTime.Today.ToShortDateString();
    var maxDay = Model.MaxDate.ToShortDateString();
}

<h1>Create Reservation</h1>

<input type="text" id="demo" />

<div class="row">
    <div class="col-md-8">
        <form asp-action="CreateReservation">
            <div asp-validation-summary="ModelOnly" class="text-danger"></div>

            <div class="form-group">
                <label asp-for="CustomerId" class="control-label"></label>
                @ViewBag.CustomerId
            </div>

            @* display a table to choose from *@
            <table id="sittingsTable" class="table">
                <thead></thead>
                <tbody></tbody>
            </table>

            <div class="form-group">
                <label asp-for="NumOfGuests" class="control-label">Number of Guests</label>
                <input asp-for="NumOfGuests" class="form-control" min="1" />
                <span asp-validation-for="NumOfGuests" class="text-danger"></span>
            </div>

            <div class="form-group">
                <label asp-for="StartTime" class="control-label">Expected Arrival</label>
                <input asp-for="StartTime" class="form-control" />
                <span asp-validation-for="StartTime" class="text-danger"></span>
            </div>

            <div class="form-group">
                <label asp-for="Duration" class="control-label">Expected Duration</label>
                <input asp-for="Duration" class="form-control" />
                <span asp-validation-for="Duration" class="text-danger"></span>
            </div>

            <div class="form-group">
                <label asp-for="Notes" class="control-label"></label>
                <input asp-for="Notes" class="form-control" id="notes" />
                <span asp-validation-for="Notes" class="text-danger"></span>
            </div>

            <div class="form-group">
                <input type="submit" value="Create" class="btn btn-primary" />
            </div>

        </form>
    </div>
</div>

<div>
    <a asp-action="Index">Back to List</a>
</div>

@section Scripts {

    <script type="text/javascript" src="https://cdn.jsdelivr.net/momentjs/latest/moment.min.js"></script>
    <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/daterangepicker/daterangepicker.min.js"></script>
    <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/daterangepicker/daterangepicker.css" />
    <script>
        $('#demo').daterangepicker({
            "singleDatePicker": true,
            "showCustomRangeLabel": false,
            "locale": {
                "format": "@Model.SysDateFormat",
                "separator": " - ",
                "applyLabel": "Apply",
                "cancelLabel": "Cancel",
                "fromLabel": "From",
                "toLabel": "To",
                "customRangeLabel": "Custom",
                "weekLabel": "W",
                "daysOfWeek": [
                    "Sun",
                    "Mon",
                    "Tue",
                    "Wed",
                    "Thu",
                    "Fri",
                    "Sat"
                ],
                "monthNames": [
                    "January",
                    "February",
                    "March",
                    "April",
                    "May",
                    "June",
                    "July",
                    "August",
                    "September",
                    "October",
                    "November",
                    "December"
                ],
                "firstDay": 1
            },
            "minDate": "@minDay",
            "maxDate": "@maxDay"
        }, function () { });
    </script>

<script>
    var sittings = @Json.Serialize(Model.AvailableSittings);
    var filter;
    var filteredSittings;
    $('#demo').on('change', function () {
        filter = this.value;
        filteredSittings = sittings.filter(s => s.date == filter);
        filteredSittings.forEach(
            function (e) {
                $("#sittingsTable").find('tbody').append($('<tr>').append($('<td>').text(e.date)));
            }
        );
    });
    
</script>

    @*<script src="~/lib/jquery/dist/jquery.min.js"></script>
        <script src="~/js/jquery.amsify.suggestags.js"></script>
        <link href="~/css/amsify.suggestags.css" rel="stylesheet" />
        <script>
            $(document).ready(function () {
                $('input[id="notes"]').amsifySuggestags({
                    type: 'amsify',
                    suggestions: ['Vegetarian', 'Table near window'],
                    printValues: false
                });
            });
        </script>*@

    @{await Html.RenderPartialAsync("_ValidationScriptsPartial");}
}
